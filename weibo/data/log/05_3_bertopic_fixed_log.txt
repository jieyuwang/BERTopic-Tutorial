日志文件: data/log/05_3_bertopic_fixed_log.txt
开始时间: 2025-06-29 18:35:28
============================================================
============================================================
修复版本BERTopic主题建模工具
============================================================
开始时间: 2025-06-29 18:35:28

=== 加载和预处理数据 ===
嵌入向量形状: (86816, 384)
原始文本数量: 86,816
改进的文本预处理...
预处理后文本数量: 65,485
过滤后嵌入向量形状: (65485, 384)

预处理示例:
原文1: 【杜苏芮将于28日在福建福清到广东惠来一带沿海登陆】 国家防总办公室应急管理部26日组织防汛防台风专...
处理后: 【杜苏芮将于28日在福建福清到广东惠来一带沿海登陆】 国家防总办公室应急管理部26日组织防汛防台风专...

原文2: 【国家防总提升防汛防台风应急响应至三级】今年第5号台风杜苏芮逐渐向闽粤沿海靠近。记者26日从应急管理...
处理后: 【国家防总提升防汛防台风应急响应至三级】今年第5号台风杜苏芮逐渐向闽粤沿海靠近。记者26日从应急管理...

原文3: 【】 7月26日，国家防总办公室应急管理部组织防汛防台风专题视频会商调度，与中国气象局水利部自然资源...
处理后: 【】 7月26日，国家防总办公室应急管理部组织防汛防台风专题视频会商调度，与中国气象局水利部自然资源...


=== 创建修复版本BERTopic模型 ===
✓ 修复版本BERTopic模型配置完成
✓ 使用改进的中文分词和文本清洗
✓ 限制主题数量为20个，改善可视化效果

先使用前15,000个样本进行测试...

=== 训练修复版本模型 ===
使用前 15,000 个样本进行训练
训练数据规模: 15,000 个文档
嵌入向量维度: 384
开始训练...
✓ 训练完成！
✓ 训练用时: 0.6 分钟
✓ 发现主题数量: 20

=== 修复版本结果分析 ===
主题统计信息:
   Topic  ...                                Representative_Docs
0     -1  ...  [【 北运河流域可能出现橙色预警级别洪水】北京市水文总站于7月30日0时发布洪水橙色预警：预...
1      0  ...  [【】受台风杜苏芮影响，北京多地连日普降大到暴雨，尤其房山门头沟降雨量更是远超721，对城市...
2      1  ...  [2023年7月31日，受台风影响，京津冀遭遇强降雨。记者了解到，河北市码头镇丹佛尔湾小区内...
3      2  ...  [【：一沿河小区百余人受困，洪水已漫过一楼】 2023年7月31日，受台风影响，京津冀遭遇强...
4      3  ...  [【】 7月30日，从乌海西开往北京丰台的K396次列车，因暴雨遇突发事件，在中途停留，一女...
5      4  ...  [【：一沿河小区百余人受困，洪水已漫过一楼】 2023年7月31日，受台风影响，京津冀遭遇强...
6      5  ...  [【】据 消息，受台风影响，京津冀地区持续强降雨，导致北京丰台至沙城铁路（丰沙线）严重水害，...
7      6  ...  [【：一沿河小区百余人受困，洪水已漫过一楼】 2023年7月31日，受台风影响，京津冀遭遇强...
8      7  ...  [开的不是车，是潜水艇cars01车闻超话 LCars01的微博视频, 【】 据 ：受今年第...
9      8  ...  [【视线500m秒！北京永定河现今年1号洪水 水流湍急水位高涨】O直击500m秒！北京永定河...

[10 rows x 5 columns]

主题分布 (前15个):
异常值主题: 5,787 个文档
主题 0: 2,377 个文档 - 0 0, a, 0 1, 2 2, 2 9, 2 1, 1 7, 5 0, 2 5, 3 2
主题 1: 2,178 个文档 - 0 1, m, 0 0, 8 0, 1 4, 4 0, 5 0, c m, 2 1, c
主题 2: 1,225 个文档 - d, 7 2, 2 8, 3 7, g, 2 7, 6 2, 3 2, d 2, 8 g
主题 3: 796 个文档 - 0 0, 1 4, 1 o,   8, o  , c, 8 8,   1, 0 1, 4 0
主题 4: 661 个文档 - 0 l, i, i i, 0 0, 2 1, c, 0 7, 7 0, 1 9, 1  
主题 5: 371 个文档 -   8, 6 z, 9 6, k 3, z 1, k, 3 9, 0 l, 8 0, 4 0
主题 6: 274 个文档 - e, 8 3, c m, 5 1, 8 8,   3, 7 8, c, 1 7, 1 o
主题 7: 191 个文档 - 8 0, c, k 3, c m, k, 0 0, 4 0, 9 6, z 1, 3 9
主题 8: 171 个文档 - 0 a, 0 0, a, a 2, m 1, 5 a,   5, 0 m, m, 1 7
主题 9: 131 个文档 - k, 1 6, 0 0, 6 6, 0 3, 8 0, k 7, 0 k, 4 l, 8 2
主题 10: 123 个文档 - 1 l,   8, o 9, 1 z, o  , m 8, 4 2, 3 o, 7 o, 6 1
主题 11: 118 个文档 - 0 0, l 0, v i, i a, v, 1 z, a l, 1 v, 5 v, i
主题 12: 115 个文档 - 0 8, 1 l, 0 1, v i, i a, s h, h 6, v, 5 4, 9 7
主题 13: 113 个文档 - k 3, 9 6, k, 3 9, 6  , o k, z 1, 2 1, z, 5 z

异常值统计:
  异常值数量: 5,787
  异常值比例: 38.6%

=== 保存修复版本结果 ===
✓ 创建输出目录: results/fixed_results
✓ 主题建模结果已保存到: results/fixed_results/topic_modeling_results_fixed.csv
✓ 主题信息已保存到: results/fixed_results/topic_info_fixed.csv
✓ BERTopic模型已保存到: results/fixed_results/bertopic_model_fixed

=== 创建可视化图表 ===
创建主题分布图...
✓ 主题分布图已保存到: results/fixed_results/visualizations/topic_distribution.png
创建主题关键词热力图...
✓ 主题关键词热力图已保存到: results/fixed_results/visualizations/topic_keywords_heatmap.png
创建文档分布饼图...
✓ 文档分布饼图已保存到: results/fixed_results/visualizations/document_distribution.png
创建主题概率分布图...
✓ 主题概率分布图已保存到: results/fixed_results/visualizations/topic_probability_distribution.png

=== 生成修复版本分析报告 ===
✓ 修复版本分析报告已保存到: results/fixed_results/visualizations/fixed_topic_analysis_report.txt

修复版本微博主题建模分析报告
==================================================

数据概览:
- 总文档数: 15,000
- 有效主题数: 19
- 异常值文档数: 5,787 (38.6%)
- 平均主题概率: 0.429
- 主题概率范围: 0.001 - 1.000

主题详情:

主题 0: 0_0 0_a_0 1_2 2
- 文档数: 2,377 (15.8%)
- 关键词: 0 0, a, 0 1, 2 2, 2 9, 2 1, 1 7, 5 0, 2 5, 3 2, 1 4, 0 l, 0 3, o  , 4 0

主题 1: 1_0 1_m_0 0_8 0
- 文档数: 2,178 (14.5%)
- 关键词: 0 1, m, 0 0, 8 0, 1 4, 4 0, 5 0, c m, 2 1, c, 5 1, 0 l,   2, 0 7, 7 0

主题 2: 2_d_7 2_2 8_3 7
- 文档数: 1,225 (8.2%)
- 关键词: d, 7 2, 2 8, 3 7, g, 2 7, 6 2, 3 2, d 2, 8 g, 0 0, 2 9, 6 5, 2 6,   m

主题 3: 3_0 0_1 4_1 o_  8
- 文档数: 796 (5.3%)
- 关键词: 0 0, 1 4, 1 o,   8, o  , c, 8 8,   1, 0 1, 4 0, 9 9, 8 3, 9 1, 0 l, 2 1

主题 4: 4_0 l_i_i i_0 0
- 文档数: 661 (4.4%)
- 关键词: 0 l, i, i i, 0 0, 2 1, c, 0 7, 7 0, 1 9, 1  , 8 0, 5 1,   3, 4 2, 9 2

主题 5: 5_  8_6 z_9 6_k 3
- 文档数: 371 (2.5%)
- 关键词:   8, 6 z, 9 6, k 3, z 1, k, 3 9, 0 l, 8 0, 4 0, z, 8 8, 0 0, 3 5, 6 8

主题 6: 6_e_8 3_c m_5 1
- 文档数: 274 (1.8%)
- 关键词: e, 8 3, c m, 5 1, 8 8,   3, 7 8, c, 1 7, 1 o, 9 1, 3 5,   1, 4 9, k 1

主题 7: 7_8 0_c_k 3_c m
- 文档数: 191 (1.3%)
- 关键词: 8 0, c, k 3, c m, k, 0 0, 4 0, 9 6, z 1, 3 9, 9 2, 5 8, z, 1 4, a l

主题 8: 8_0 a_0 0_a_a 2
- 文档数: 171 (1.1%)
- 关键词: 0 a, 0 0, a, a 2, m 1, 5 a,   5, 0 m, m, 1 7, 5 0, 0 7, 9 0, 7 0, 0 1

主题 9: 9_k_1 6_0 0_6 6
- 文档数: 131 (0.9%)
- 关键词: k, 1 6, 0 0, 6 6, 0 3, 8 0, k 7, 0 k, 4 l, 8 2, 6  , 6 0, 2 1, 5 5,   3

主题 10: 10_1 l_  8_o 9_1 z
- 文档数: 123 (0.8%)
- 关键词: 1 l,   8, o 9, 1 z, o  , m 8, 4 2, 3 o, 7 o, 6 1, 1 4, 9 0, 2 1, 3 8, 2 o

主题 11: 11_0 0_l 0_v i_i a
- 文档数: 118 (0.8%)
- 关键词: 0 0, l 0, v i, i a, v, 1 z, a l, 1 v, 5 v, i, a, 1 6,   8, 0 1, 8 o

主题 12: 12_0 8_1 l_0 1_v i
- 文档数: 115 (0.8%)
- 关键词: 0 8, 1 l, 0 1, v i, i a, s h, h 6, v, 5 4, 9 7, 5 0,   s, 4 1, 8 0, o  

主题 13: 13_k 3_9 6_k_3 9
- 文档数: 113 (0.8%)
- 关键词: k 3, 9 6, k, 3 9, 6  , o k, z 1, 2 1, z, 5 z, 2 9, 9 o, 8 k, 2 o, c m

可视化文件:
1. results/fixed_results/visualizations/topic_distribution.png - 主题分布图
2. results/fixed_results/visualizations/topic_keywords_heatmap.png - 主题关键词热力图
3. results/fixed_results/visualizations/document_distribution.png - 文档分布饼图
4. results/fixed_results/visualizations/topic_probability_distribution.png - 主题概率分布图

改进说明:
- 使用改进的中文分词器，过滤英文和数字
- 增强文本清洗，移除URL和特殊字符
- 使用1-gram和2-gram特征
- 优化聚类参数，减少异常值
- 添加完整的可视化功能


输出文件:
1. results/fixed_results/topic_modeling_results_fixed.csv - 修复版本主题建模结果
2. results/fixed_results/topic_info_fixed.csv - 修复版本主题信息
3. results/fixed_results/bertopic_model_fixed - 修复版本模型
4. results/fixed_results/visualizations/ - 可视化图表目录

日志文件: data/log/05_3_bertopic_fixed_log.txt
============================================================
修复版本BERTopic主题建模完成！
============================================================
