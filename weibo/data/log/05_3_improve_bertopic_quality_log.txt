日志文件: data/log/05_3_improve_bertopic_quality_log.txt
开始时间: 2025-07-05 13:04:35
============================================================
============================================================
改进版BERTopic主题建模工具（适度文本清洗）
============================================================
开始时间: 2025-07-05 13:04:35

=== 加载和预处理数据 ===
嵌入向量形状: (86816, 384)
已分词文本数量: 86,816
清洗文本：只保留中文词汇...
清洗后文本数量: 86,816
过滤后嵌入向量形状: (86816, 384)
清洗比例: 100.0%
清洗后总词汇数: 3,599,786
清洗后唯一词汇数: 75,565
平均每文档词汇数: 41.5

清洗示例:
原文1: 杜苏芮 福建 福清 广东 惠来 一带 沿海 登陆 国家 防总 办公室 应急 管理部 组织 防汛防台 专题 会商 调度 中国气象局 水利部 自然资源 会商 研判 今年 台风 杜苏芮 发展 态势 连线 福...
清洗后: 杜苏芮 福建 福清 广东 惠来 一带 沿海 登陆 国家 防总 办公室 应急 管理部 组织 防汛防台 专题 会商 调度 中国气象局 水利部 自然资源 会商 研判 今年 台风 杜苏芮 发展 态势 连线 福...

原文2: 国家 防总 提升 防汛防台 应急 响应 三级 今年 台风 杜苏芮 逐渐 闽粤 沿海 靠近 应急 管理部 获悉 国家 防总 当日 防汛防台 应急 响应 提升 三级 派出 工作组 浙江 福建 广东 江西 ...
清洗后: 国家 防总 提升 防汛防台 应急 响应 三级 今年 台风 杜苏芮 逐渐 闽粤 沿海 靠近 应急 管理部 获悉 国家 防总 当日 防汛防台 应急 响应 提升 三级 派出 工作组 浙江 福建 广东 江西 ...

原文3: 国家 防总 办公室 应急 管理部 组织 防汛防台 专题 会商 调度 中国气象局 水利部 自然资源 会商 研判 今年 台风 杜苏芮 发展 态势 连线 福建 广东 浙江 四川 省份 防指 办公室 调度 部...
清洗后: 国家 防总 办公室 应急 管理部 组织 防汛防台 专题 会商 调度 中国气象局 水利部 自然资源 会商 研判 今年 台风 杜苏芮 发展 态势 连线 福建 广东 浙江 四川 省份 防指 办公室 调度 部...


=== 创建高质量BERTopic模型 ===
✓ 默认配置BERTopic模型完成
✓ 使用BERTopic默认参数

先使用前15,000个样本进行测试...

=== 训练改进版模型 ===
使用前 1,000 个样本进行训练（调试模式）
没有发现空文本
过滤后空文本数量: 0
训练数据规模: 1,000 个文档
嵌入向量维度: 384
非空文本数量: 1000 / 1000
大批量文本词汇数量: 6831
词汇示例: ['一丈' '一下' '一个甲子' '一二尺' '一人' '一份' '一位' '一体化' '一倍' '一切正常' '一半' '一单' '一口气'
 '一只' '一号' '一名' '一周' '一命' '一图' '一场']

=== 调试CountVectorizer输出 ===
原文1: 杜苏芮 福建 福清 广东 惠来 一带 沿海 登陆 国家 防总 办公室 应急 管理部 组织 防汛防台 ...
词汇数量: 130
词汇示例: ['一带' '上午' '上岸' '不死' '专题' '东北部' '严要求' '中国气象局' '中小' '人员']

原文2: 国家 防总 提升 防汛防台 应急 响应 三级 今年 台风 杜苏芮 逐渐 闽粤 沿海 靠近 应急 管理...
词汇数量: 144
词汇示例: ['一带' '三级' '上午' '上岸' '专题' '东北部' '中国气象局' '中小' '人员' '今年']

原文3: 国家 防总 办公室 应急 管理部 组织 防汛防台 专题 会商 调度 中国气象局 水利部 自然资源 会...
词汇数量: 155
词汇示例: ['一带' '三级' '上午' '上岸' '不死' '专题' '东北部' '严要求' '中国气象局' '中小']

开始训练...

=== 详细调试训练文本 ===
训练文本数量: 1000
前5条训练文本:
  文本1: '杜苏芮 福建 福清 广东 惠来 一带 沿海 登陆 国家 防总 办公室 应急 管理部 组织 防汛防台 专题 会商 调度 中国气象局 水利部 自然资源 会商 研判 今年 台风 杜苏芮 发展 态势 连线 福...'
  长度: 551, 是否为空: False
  文本2: '国家 防总 提升 防汛防台 应急 响应 三级 今年 台风 杜苏芮 逐渐 闽粤 沿海 靠近 应急 管理部 获悉 国家 防总 当日 防汛防台 应急 响应 提升 三级 派出 工作组 浙江 福建 广东 江西 ...'
  长度: 656, 是否为空: False
  文本3: '国家 防总 办公室 应急 管理部 组织 防汛防台 专题 会商 调度 中国气象局 水利部 自然资源 会商 研判 今年 台风 杜苏芮 发展 态势 连线 福建 广东 浙江 四川 省份 防指 办公室 调度 部...'
  长度: 657, 是否为空: False
  文本4: '遥遥 想起 两年 大约 去往 北京 高铁 途径 河南 害怕 暴雨 余波 火车 冲垮 彻夜难眠 回程 洪水 毁掉 庄稼 农田 车厢 安静 令人窒息...'
  长度: 72, 是否为空: False
  文本5: '焉知 不是 命运...'
  长度: 8, 是否为空: False

=== 手动调试BERTopic聚类过程 ===
1. 降维...
   降维后形状: (1000, 5)
2. 聚类...
   聚类结果: {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, -1}
   聚类数量: 35
   每个聚类的文档数量:
     聚类-1: 116 个文档
     聚类3: 80 个文档
     聚类24: 74 个文档
     聚类1: 59 个文档
     聚类2: 48 个文档
     聚类20: 35 个文档
     聚类31: 32 个文档
     聚类4: 31 个文档
     聚类10: 30 个文档
     聚类21: 29 个文档
     聚类25: 29 个文档
     聚类5: 28 个文档
     聚类29: 27 个文档
     聚类17: 27 个文档
     聚类33: 23 个文档
     聚类19: 23 个文档
     聚类6: 23 个文档
     聚类16: 22 个文档
     聚类32: 20 个文档
     聚类26: 20 个文档
     聚类30: 19 个文档
     聚类14: 19 个文档
     聚类8: 19 个文档
     聚类28: 18 个文档
     聚类22: 18 个文档
     聚类12: 16 个文档
     聚类18: 16 个文档
     聚类23: 15 个文档
     聚类11: 14 个文档
     聚类27: 13 个文档
     聚类15: 12 个文档
     聚类9: 12 个文档
     聚类0: 12 个文档
     聚类13: 11 个文档
     聚类7: 10 个文档
5. 模拟_c_tf_idf过程...
   聚类0: 12个文档，合并后长度: 2813
   聚类1: 59个文档，合并后长度: 11495
   聚类2: 48个文档，合并后长度: 8123
   聚类3: 80个文档，合并后长度: 15560
   聚类4: 31个文档，合并后长度: 2438
   聚类5: 28个文档，合并后长度: 4301
   聚类6: 23个文档，合并后长度: 2357
   聚类7: 10个文档，合并后长度: 1311
   聚类8: 19个文档，合并后长度: 3060
   聚类9: 12个文档，合并后长度: 1096
   聚类10: 30个文档，合并后长度: 3362
   聚类11: 14个文档，合并后长度: 1276
   聚类12: 16个文档，合并后长度: 137
   聚类13: 11个文档，合并后长度: 1061
   聚类14: 19个文档，合并后长度: 1709
   聚类15: 12个文档，合并后长度: 15148
   聚类16: 22个文档，合并后长度: 2807
   聚类17: 27个文档，合并后长度: 100
   聚类18: 16个文档，合并后长度: 2688
   聚类19: 23个文档，合并后长度: 26231
   聚类20: 35个文档，合并后长度: 23880
   聚类21: 29个文档，合并后长度: 230
   聚类22: 18个文档，合并后长度: 23706
   聚类23: 15个文档，合并后长度: 12176
   聚类24: 74个文档，合并后长度: 43819
   聚类25: 29个文档，合并后长度: 21073
   聚类26: 20个文档，合并后长度: 13310
   聚类27: 13个文档，合并后长度: 15210
   聚类28: 18个文档，合并后长度: 17633
   聚类29: 27个文档，合并后长度: 248
   聚类30: 19个文档，合并后长度: 346
   聚类31: 32个文档，合并后长度: 3089
   聚类32: 20个文档，合并后长度: 556
   聚类33: 23个文档，合并后长度: 2090
6. 测试vectorizer.fit...
   成功提取词汇: 5978个
   词汇示例: ['一丈' '一下' '一个甲子' '一二尺' '一人' '一份' '一位' '一体化' '一倍' '一切正常']
✗ 训练失败: empty vocabulary; perhaps the documents only contain stop words
小样本训练失败，程序退出
